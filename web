<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Checklist de Trade — RR Automático</title>
<style>
  :root { --ok:#10b981; --bad:#ef4444; --mid:#f59e0b; --bg:#0b1220; --card:#121a2b; --text:#e5e7eb; --muted:#94a3b8; }
  body{margin:0;font-family:system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial,sans-serif;background:var(--bg);color:var(--text);display:flex;justify-content:center;align-items:flex-start;padding:24px}
  .card{width:min(980px,100%);background:var(--card);border-radius:16px;box-shadow:0 10px 30px rgba(0,0,0,.35);padding:20px}
  h1{margin:0 0 12px;font-size:22px}
  p.hint{color:var(--muted);margin:4px 0 14px}
  .grid{display:grid;grid-template-columns:repeat(6,1fr);gap:10px;align-items:end}
  label{font-size:12px;color:var(--muted)}
  input,select{width:100%;padding:10px 12px;border-radius:10px;border:1px solid #243047;background:#0e1626;color:var(--text);outline:none}
  input:focus,select:focus{border-color:#3b82f6;box-shadow:0 0 0 3px rgba(59,130,246,.25)}
  table{width:100%;border-collapse:collapse;margin-top:16px}
  th,td{padding:10px 12px;border-bottom:1px solid #22304c;text-align:right}
  th{text-align:center;color:#c7d2fe;font-weight:600;background:#0f182b}
  td.label, th.label{text-align:left}
  .pill{display:inline-block;padding:4px 10px;border-radius:999px;font-size:12px;font-weight:700}
  .ok{background:color-mix(in oklab, var(--ok) 25%, transparent);color:var(--ok);border:1px solid var(--ok)}
  .bad{background:color-mix(in oklab, var(--bad) 20%, transparent);color:var(--bad);border:1px solid var(--bad)}
  .mid{background:color-mix(in oklab, var(--mid) 20%, transparent);color:var(--mid);border:1px solid var(--mid)}
  .footer{display:flex;gap:8px;flex-wrap:wrap;margin-top:12px;color:#a3b2cc;font-size:12px}
  .small{font-size:12px;color:var(--muted)}
</style>
</head>
<body>
  <div class="card">
    <h1>Checklist de Trade — Risco x Retorno (RR)</h1>
    <p class="hint">Preencha <b>Entrada</b>, <b>Stop</b> e alvos. Selecione a direção (Long/Short). A tabela calcula <i>Risco</i>, <i>Retorno</i> e <i>RR</i> automaticamente.</p>

    <div class="grid">
      <div>
        <label for="direcao">Direção</label>
        <select id="direcao">
          <option value="long">Long (Compra)</option>
          <option value="short">Short (Venda)</option>
        </select>
      </div>
      <div>
        <label for="entrada">Entrada</label>
        <input id="entrada" type="number" step="0.01" placeholder="ex: 115000" />
      </div>
      <div>
        <label for="stop">Stop</label>
        <input id="stop" type="number" step="0.01" placeholder="ex: 114400" />
      </div>
      <div>
        <label for="alvo1">Alvo 1</label>
        <input id="alvo1" type="number" step="0.01" placeholder="ex: 115700" />
      </div>
      <div>
        <label for="alvo2">Alvo 2</label>
        <input id="alvo2" type="number" step="0.01" placeholder="opcional" />
      </div>
      <div>
        <label for="alvo3">Alvo 3</label>
        <input id="alvo3" type="number" step="0.01" placeholder="opcional" />
      </div>
    </div>

    <table>
      <thead>
        <tr>
          <th class="label">Nível</th>
          <th>Risco</th>
          <th>Retorno</th>
          <th>RR</th>
          <th>Decisão</th>
        </tr>
      </thead>
      <tbody id="rows">
        <tr>
          <td class="label">Alvo 1</td>
          <td id="r1">—</td>
          <td id="ret1">—</td>
          <td id="rr1">—</td>
          <td id="d1">—</td>
        </tr>
        <tr>
          <td class="label">Alvo 2</td>
          <td id="r2">—</td>
          <td id="ret2">—</td>
          <td id="rr2">—</td>
          <td id="d2">—</td>
        </tr>
        <tr>
          <td class="label">Alvo 3</td>
          <td id="r3">—</td>
          <td id="ret3">—</td>
          <td id="rr3">—</td>
          <td id="d3">—</td>
        </tr>
      </tbody>
    </table>

    <p class="small">Regra salva: operar apenas quando <b>RR ≥ 2:1</b> (preferência). Ajuste conforme o contexto do gráfico.</p>

    <div class="footer">
      <span id="summary" class="pill mid">Preencha os campos…</span>
    </div>
  </div>

<script>
(function(){
  const $ = id => document.getElementById(id);
  const fields = ['direcao','entrada','stop','alvo1','alvo2','alvo3'].map($);

  function fmt(n){
    if(!isFinite(n)) return '—';
    const abs = Math.abs(n);
    return (abs >= 1000) ? n.toFixed(0) : n.toFixed(2);
  }
  function pill(el, rr){
    el.className = 'pill ' + (rr>=2 ? 'ok' : (rr>0 ? 'mid' : 'bad'));
    el.textContent = rr>=2 ? 'Trade Válido (RR ≥ 2)' : (rr>0 ? 'RR baixo' : 'Inválido');
  }
  function setCell(id, val){ $(id).textContent = val; }

  function computeForTarget(target, idx){
    const dir = $('direcao').value;
    const e = parseFloat($('entrada').value);
    const s = parseFloat($('stop').value);
    const t = parseFloat($(target).value);

    if(!isFinite(e) || !isFinite(s) || !isFinite(t)) {
      setCell('r'+idx,'—'); setCell('ret'+idx,'—'); setCell('rr'+idx,'—'); $('d'+idx).textContent = '—';
      return NaN;
    }

    // risco é a distância até o stop (sempre positiva)
    const risco = Math.abs(s - e);

    // retorno depende da direção
    let retorno = 0;
    if(dir==='long'){
      retorno = t - e;        // alvo acima da entrada
    } else { // short
      retorno = e - t;        // alvo abaixo da entrada
    }

    const rr = retorno / risco;

    setCell('r'+idx, fmt(risco));
    setCell('ret'+idx, fmt(retorno));
    setCell('rr'+idx, isFinite(rr) ? rr.toFixed(2)+':1' : '—');

    const badge = document.createElement('span');
    pill(badge, rr);
    const cell = $('d'+idx);
    cell.innerHTML = ''; cell.appendChild(badge);

    return rr;
  }

  function update(){
    const rr1 = computeForTarget('alvo1',1);
    const rr2 = computeForTarget('alvo2',2);
    const rr3 = computeForTarget('alvo3',3);

    // resumo geral (melhor RR válido)
    const arr = [rr1, rr2, rr3].filter(x=>isFinite(x));
    const summary = $('summary');
    if(arr.length===0){ summary.className='pill mid'; summary.textContent='Preencha Entrada, Stop e pelo menos 1 Alvo'; return; }
    const best = Math.max.apply(null, arr);
    pill(summary, best);
    summary.textContent += ` • Melhor RR: ${best.toFixed(2)}:1`;
  }

  fields.forEach(el => el.addEventListener('input', update));
  update();
})();
</script>
</body>
</html>
